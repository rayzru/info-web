# üè¢ –°—Ç—Ä–æ–µ–Ω–∏–µ 4: –ú–∏–≥—Ä–∞—Ü–∏—è –∫–≤–∞—Ä—Ç–∏—Ä - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

## üìä –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–î–∞—Ç–∞**: 2026-02-14
**–°—Ç—Ä–æ–µ–Ω–∏–µ**: 4 (–õ–∏—Ç–µ—Ä 1)
**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –°—Ç—Ä–æ–µ–Ω–∏—è 2, –ø–æ–¥—ä–µ–∑–¥ 1
**–í—Å–µ–≥–æ –∫–≤–∞—Ä—Ç–∏—Ä**: 253

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–°—Ç—Ä–æ–µ–Ω–∏–µ 4 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç—É –∂–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫—É, —á—Ç–æ –∏ –°—Ç—Ä–æ–µ–Ω–∏–µ 2, –ø–æ–¥—ä–µ–∑–¥ 1**:

| –ü–æ–¥—ä–µ–∑–¥ | –≠—Ç–∞–∂–∏ | –ö–≤–∞—Ä—Ç–∏—Ä –Ω–∞ —ç—Ç–∞–∂ | –î–∏–∞–ø–∞–∑–æ–Ω –∫–≤–∞—Ä—Ç–∏—Ä | –í—Å–µ–≥–æ –∫–≤–∞—Ä—Ç–∏—Ä |
|---------|-------|-----------------|------------------|---------------|
| 1       | 2-24  | 11              | 1-253           | 253           |

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –≠—Ç–∞–∂ 1 - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π (–±–µ–∑ –∫–≤–∞—Ä—Ç–∏—Ä)
- –ù—É–º–µ—Ä–∞—Ü–∏—è –∫–≤–∞—Ä—Ç–∏—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å **1** (–Ω–∞ 2-–º —ç—Ç–∞–∂–µ)
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–∂–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –°—Ç—Ä–æ–µ–Ω–∏—é 2, –ø–æ–¥—ä–µ–∑–¥—É 1

### 2. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∫–≤–∞—Ä—Ç–∏—Ä

**–§–∞–π–ª**: `drizzle/0027_add_building4_apartments.sql`

–ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ 253 –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–æ–π:

#### –¢–∏–ø–æ–≤–∞—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ (11 –∫–≤–∞—Ä—Ç–∏—Ä –Ω–∞ —ç—Ç–∞–∂, –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–∂–∞—Ö)

```
1. 2k (–¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
2. 2k (–¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
3. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
4. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
5. 2k (–¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
6. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
7. 2k (–¥–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
8. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
9. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
10. 1k (–æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
11. 3k (—Ç—Ä—ë—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è)
```

#### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º

| –¢–∏–ø –∫–≤–∞—Ä—Ç–∏—Ä—ã | –ù–∞ —ç—Ç–∞–∂ | –í—Å–µ–≥–æ (23 —ç—Ç–∞–∂–∞) |
|--------------|---------|------------------|
| `1k`         | 6       | 138              |
| `2k`         | 4       | 92               |
| `3k`         | 1       | 23               |
| **–ò–¢–û–ì–û**    | **11**  | **253**          |

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ú–∏–≥—Ä–∞—Ü–∏–∏
1. **[drizzle/0027_add_building4_apartments.sql](drizzle/0027_add_building4_apartments.sql)**
   - –î–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ 253 –∫–≤–∞—Ä—Ç–∏—Ä—ã
   - README: [drizzle/0027_README.md](drizzle/0027_README.md)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
1. **[drizzle/0027_README.md](drizzle/0027_README.md)**
   - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –º–∏–≥—Ä–∞—Ü–∏–∏
   - SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ç–∫–∞—Ç—É

## üöÄ –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
psql $DATABASE_URL

# –í —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
BEGIN;

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
\i drizzle/0027_add_building4_apartments.sql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
SELECT
    b.number, e.entrance_number,
    COUNT(a.id) AS apt_count,
    MIN(a.number::int) AS min_apt,
    MAX(a.number::int) AS max_apt
FROM building b
JOIN entrance e ON e.building_id = b.id
LEFT JOIN floor f ON f.entrance_id = e.id
LEFT JOIN apartment a ON a.floor_id = f.id
WHERE b.number = 4
GROUP BY b.number, e.entrance_number
ORDER BY e.entrance_number;

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# building | entrance | apt_count | min_apt | max_apt
# ---------+----------+-----------+---------+---------
# 4        | 1        | 253       | 1       | 253

# –ï—Å–ª–∏ –≤—Å—ë –≤–µ—Ä–Ω–æ:
COMMIT;

# –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫:
# ROLLBACK;
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –∫–≤–∞—Ä—Ç–∏—Ä

```sql
SELECT
    a.type,
    COUNT(*) AS count
FROM apartment a
JOIN floor f ON a.floor_id = f.id
JOIN entrance e ON f.entrance_id = e.id
JOIN building b ON e.building_id = b.id
WHERE b.number = 4
GROUP BY a.type
ORDER BY a.type;

-- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
-- type | count
-- -----+------
-- 1k   | 138
-- 2k   | 92
-- 3k   | 23
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### 1. –ù–æ–≤—ã–µ —Ç–∏–ø—ã –∫–≤–∞—Ä—Ç–∏—Ä
‚úÖ **–ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∏–ø—ã: `1k`, `2k`, `3k`

### 2. –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥—Ä—É–≥–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ: –°—Ç—Ä–æ–µ–Ω–∏–µ 4 –¥–æ–ª–∂–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –±–∞–∑–µ —Å 1 –ø–æ–¥—ä–µ–∑–¥–æ–º –∏ 24 —ç—Ç–∞–∂–∞–º–∏

### 3. –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—ã:

```sql
BEGIN;

DELETE FROM apartment
WHERE floor_id IN (
  SELECT f.id FROM floor f
  JOIN entrance e ON f.entrance_id = e.id
  JOIN building b ON e.building_id = b.id
  WHERE b.number = 4
);

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å (–¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 0)
SELECT COUNT(*) FROM apartment a
JOIN floor f ON a.floor_id = f.id
JOIN entrance e ON f.entrance_id = e.id
JOIN building b ON e.building_id = b.id
WHERE b.number = 4;

COMMIT;
```

## üìã –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

### –í—Å–µ —Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–≤–∞—Ä—Ç–∏—Ä–∞–º–∏! üéâ

| –°—Ç—Ä–æ–µ–Ω–∏–µ | –ü–æ–¥—ä–µ–∑–¥–æ–≤ | –ö–≤–∞—Ä—Ç–∏—Ä | –°—Ç–∞—Ç—É—Å |
|----------|-----------|---------|--------|
| 1        | 2         | 484     | ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ |
| 2        | 2         | 495     | ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ |
| 3        | 4         | 218     | ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ |
| 4        | 1         | 253     | ‚úÖ **–ù–û–í–û–ï** |
| 5        | 3         | 728     | ‚úÖ **–ù–û–í–û–ï** |
| 6        | 2         | 484     | ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ |
| 7        | 2         | 484     | ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–æ |
| **–ò–¢–û–ì–û** | **16** | **3146** | **‚úÖ –ì–û–¢–û–í–û!** |

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏** –Ω–∞:
   - ‚è≥ Dev –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
   - ‚è≥ Beta –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
   - ‚è≥ Prod –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ beta)

2. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–±–æ –≤—Å–µ—Ö –∫–≤–∞—Ä—Ç–∏—Ä–∞—Ö

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É** —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Å–µ–º 7 —Å—Ç—Ä–æ–µ–Ω–∏—è–º

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏:
- –°–º. –¥–µ—Ç–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `drizzle/0027_README.md`
- –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å SQL-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ! –í—Å–µ 7 —Å—Ç—Ä–æ–µ–Ω–∏–π –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∫–≤–∞—Ä—Ç–∏—Ä–∞–º–∏!
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2026-02-14
**–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–≤–∞—Ä—Ç–∏—Ä**: 3146
